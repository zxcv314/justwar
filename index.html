<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>군사 전략 턴제 게임</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- 로그인 화면 -->
    <div id="login-screen">
        <h2>🎮 군사 전략 게임</h2>
        <input type="text" id="username" placeholder="사용자 이름 입력">
        <input type="password" id="password" placeholder="비밀번호 (선택)">
        <button onclick="login()">로그인</button>
        <button onclick="guestLogin()">게스트로 플레이</button>
        <p style="text-align: center; margin-top: 20px; color: #666; font-size: 14px;">
            개발자 모드: dev / dev
        </p>
    </div>

    <!-- 게임 화면 -->
    <div id="game-screen">
        <h1>🎮 군사 전략 턴제 게임</h1>
        
        <div id="status">
            <p>플레이어: <span id="current-username">Guest</span></p>
            <p>현재 턴: <span id="current-player">P1</span> (턴 <span id="turn-count">1</span>)</p>
            <p>P1 자원: <span id="p1-resources">200</span></p>
            <p>P2 자원: <span id="p2-resources">200</span></p>
            <p>남은 AP: <span id="ap-left">3</span></p>
            <button onclick="showRules()">📖 규칙</button>
            <button onclick="showStats()">📊 전적</button>
            <button onclick="toggleDevMode()" id="dev-mode-btn" style="display:none;">🔧 개발자 모드</button>
            <button onclick="logout()" class="danger">🚪 로그아웃</button>
        </div>

        <div id="map-selector" class="panel">
            <select id="map-select" onchange="changeMap()">
                <option value="classic">클래식 맵</option>
                <option value="fortress">요새 맵</option>
                <option value="corridor">복도 맵</option>
                <option value="random">랜덤 맵</option>
            </select>
        </div>

        <div class="container">
            <div style="flex: 2;">
                <div id="game-board"></div>
            </div>
            
            <div id="sidebar">
                <div class="panel">
                    <h3>🛒 구매 (1 AP)</h3>
                    <div id="buy-buttons" class="button-grid"></div>
                </div>
                
                <div class="panel">
                    <h3>💣 전술 구매 (1 AP)</h3>
                    <div id="tactic-buy-buttons" class="button-grid"></div>
                </div>
                
                <div class="panel">
                    <h3>🎯 보유 전술 사용 (1 AP)</h3>
                    <div id="my-tactics"></div>
                </div>
                
                <div class="panel">
                    <h3>⚙️ 특수 명령</h3>
                    <button onclick="infantryCommand('move')">보병 전체 이동</button>
                    <button onclick="infantryCommand('attack')">보병 전체 타격</button>
                </div>
                
                <div class="panel" id="unit-controls" style="display:none;">
                    <h3>선택 유닛: <span id="selected-unit-name"></span></h3>
                    <div id="unit-info-panel"></div>
                    <div class="button-grid" style="margin-top: 10px;">
                        <button onclick="performAction('move')">이동</button>
                        <button onclick="performAction('attack')">공격</button>
                        <button onclick="performAction('special')">특수</button>
                        <button onclick="cancelSelection()" class="danger">취소</button>
                    </div>
                </div>
                
                <div class="panel">
                    <button onclick="endTurn()" style="width: 100%; font-size: 16px;">턴 종료</button>
                </div>
            </div>
        </div>

        <div id="log" class="panel">
            <h3>📜 게임 로그</h3>
            <ul id="log-list"></ul>
        </div>
    </div>

    <!-- 턴 전환 오버레이 -->
    <div id="turn-overlay">
        <h2 id="turn-text">P1 턴 시작</h2>
    </div>

    <!-- 규칙 모달 -->
    <div id="rules-modal" class="modal">
        <div class="modal-content">
            <h2>📜 게임 규칙</h2>
            <h3>승리 조건</h3>
            <p>상대 기지 HP를 0으로 만들면 승리</p>
            
            <h3>기본 규칙</h3>
            <ul>
                <li>턴당 3 AP 사용 가능</li>
                <li>구매/이동/공격 각 1 AP 소모</li>
                <li>턴 종료 시 자원 +200</li>
                <li>구매한 유닛은 즉시 행동 가능</li>
            </ul>
            
            <h3>지형</h3>
            <ul>
                <li>평지 ⛰️: 기본 지형</li>
                <li>숲 🌲: 사거리 절반 (내림)</li>
                <li>건물 🏢: 사거리 절반 (내림)</li>
            </ul>
            
            <h3>유닛 종류</h3>
            <table class="stats-table">
                <tr><th>유닛</th><th>비용</th><th>공격</th><th>체력</th><th>사거리</th><th>이동</th><th>특수능력</th></tr>
                <tr><td>보병 부대</td><td>100</td><td>1</td><td>1</td><td>1</td><td>1</td><td>집단명령</td></tr>
                <tr><td>보병 중대</td><td>200</td><td>1</td><td>3</td><td>1</td><td>1</td><td>-</td></tr>
                <tr><td>기계화 보병</td><td>200</td><td>2</td><td>1</td><td>2</td><td>1</td><td>대공</td></tr>
                <tr><td>장갑차</td><td>250</td><td>2</td><td>3</td><td>1</td><td>2</td><td>기갑</td></tr>
                <tr><td>탱크</td><td>400</td><td>3</td><td>5</td><td>1</td><td>1</td><td>기갑</td></tr>
                <tr><td>공격헬기</td><td>350</td><td>3</td><td>1</td><td>2</td><td>3</td><td>공중</td></tr>
                <tr><td>저격수</td><td>300</td><td>2</td><td>1</td><td>4</td><td>2</td><td>기갑무효</td></tr>
                <tr><td>자폭드론</td><td>100</td><td>2</td><td>1</td><td>0</td><td>2</td><td>자폭(AP0)</td></tr>
                <tr><td>자주포</td><td>400</td><td>3</td><td>1</td><td>3</td><td>1</td><td>정확사거리3</td></tr>
                <tr><td>방공포대</td><td>400</td><td>2</td><td>1</td><td>4</td><td>1</td><td>대공전용</td></tr>
                <tr><td>전투기</td><td>600</td><td>1</td><td>1</td><td>1</td><td>3</td><td>이동+공격</td></tr>
                <tr><td>델타포스</td><td>800</td><td>3</td><td>4</td><td>3</td><td>3</td><td>폭격면역</td></tr>
                <tr><td>시모 해위해</td><td>1200</td><td>5</td><td>1</td><td>6</td><td>1</td><td>폭격면역,숲무시</td></tr>
            </table>
            
            <h3>전술</h3>
            <ul>
                <li>전술 폭격 (450원): 타겟 노드의 모든 유닛 제거 (면역 유닛 제외, 방공포대로 차단 가능)</li>
                <li>헬파이어 폭격 (450원): 3 데미지 + 2턴간 1 데미지 지속</li>
            </ul>
            
            <button onclick="closeModal('rules-modal')" style="width: 100%; margin-top: 20px;">닫기</button>
        </div>
    </div>

    <!-- 전적 모달 -->
    <div id="stats-modal" class="modal">
        <div class="modal-content">
            <h2>📊 전적</h2>
            <div id="stats-content"></div>
            <button onclick="closeModal('stats-modal')" style="width: 100%; margin-top: 20px;">닫기</button>
        </div>
    </div>

    <script src="game.js"></script>
</body>
</html>
